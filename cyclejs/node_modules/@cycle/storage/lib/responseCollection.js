"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

exports.default = function (request$) {
  var local$ = request$.filter(function (req) {
    return !req.target || req.target === "local";
  });
  var session$ = request$.filter(function (req) {
    return req.target === "session";
  });

  return {
    // For localStorage.
    local: {
      key: function key(n) {
        // Function returning Observable of the nth key.
        return local$.filter(function (req) {
          return req.key === localStorage.key(n);
        }).map(function (req) {
          return req.key;
        }).startWith(localStorage.key(n)).distinctUntilChanged();
      },

      // Function returning Observable of item values.
      getItem: function getItem(key) {
        return local$.filter(function (req) {
          return req.key === key;
        }).map(function (req) {
          return req.value;
        }).startWith(localStorage.getItem(key));
      }
    },
    // For sessionStorage.
    session: {
      // Function returning Observable of the nth key.

      key: function key(n) {
        return session$.filter(function (req) {
          return req.key === sessionStorage.key(n);
        }).map(function (req) {
          return req.key;
        }).startWith(sessionStorage.key(n)).distinctUntilChanged();
      },

      // Function returning Observable of values.
      getItem: function getItem(key) {
        return session$.filter(function (req) {
          return req.key === key;
        }).map(function (req) {
          return req.value;
        }).startWith(sessionStorage.getItem(key));
      }
    }
  };
};